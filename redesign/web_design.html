<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Scrollytelling</title>
  <style>
      @font-face {
            font-family: 'fredoka';
            src: url('fonts/FredokaOne-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

.ring{
    transform-origin: center;
    transform: rotate(30deg);

}
.ring-clip{
    transform-origin: center;
    /* Input Position = Desired Position - 90 - 7.2 */
    transform: rotate(22.8deg); 
    stroke-width: 0.3em;
    stroke:white;
    transition: transform 1s;
}

.ring circle {
  stroke-dashoffset: 0;
  transition: stroke-dashoffset 1s;
  stroke: rgb(229, 229, 229);
  stroke-width: 1em;
}

#badge{
    fill:rgb(229, 229, 229);
    stroke:white;
    stroke-width: 0.25em;
    transform-origin: center;
    transform: rotate(120deg);
}

#svg #bar {
  stroke: #FF9F1E;
  stroke-dashoffset: 565px;
}

#cont {
  display: block;
  height: 200px;
  width: 200px;
  margin: 2em auto;
  border-radius: 100%;
  position: relative;
}
#ring-label {
  font-family: 'fredoka';
  font-size: 2em;
}

input {
  color: #000;
}

@keyframes shake {
  0% { transform: rotate(0deg); transform-origin: center;}
  10% { transform: rotate(2deg); transform-origin: center;}
  20% { transform: rotate(0deg); transform-origin: center;}
  30% { transform: rotate(-2deg); transform-origin: center;}
  40% { transform: rotate(0deg); transform-origin: center;}
  50% { transform: rotate(0deg); transform-origin: center;}
  60% { transform: rotate(0deg); transform-origin: center;}
  70% { transform: rotate(0deg); transform-origin: center;}
  80% { transform: rotate(0deg); transform-origin: center;}
  90% { transform: rotate(0deg); transform-origin: center;}
  100% { transform: rotate(0deg); transform-origin: center;}
}

.ring-center{
    opacity:100%;
  animation-timing-function: linear;
  animation: glow 5s;
  animation-iteration-count: infinite;
}
@keyframes glow {
  0% { opacity:100%;}
  50% { opacity:50%;}
  100% { opacity:100%;}
}


/* Make things perty */
  </style>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

</head>

<body>
    <h1>SVG Circle Progress</h1>
    <h2>Based off of CSS3 circle progress bars</h2>
    
    <div id="cont" data-pct="100" style="text-align:center">
      <svg id="svg" width="200" height="200" viewPort="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <g >
            <circle class="ring-center" r="60" cx="100" cy="100" fill="rgb(28, 176, 246)"></circle>
            <text x="83" y="110" id="ring-label">#1</text>
        </g>
        <g class="ring">
            <circle r="90" cx="100" cy="100" fill="transparent" stroke-dasharray="565.48" stroke-dashoffset="0"></circle>
        </g>
        <g class="ring">
            <circle id="bar" r="90" cx="100" cy="100" fill="transparent" stroke-dasharray="565.48" stroke-dashoffset="0"></circle>
        </g>
        <g  class="ring-clip">
            <circle r="12.5" cx="190" cy="100" fill="transparent" stroke-dasharray="20" id="ring-clip-circle"></circle>
        </g>
        <g>
            <circle id="badge" r="25" cx="100" cy="12.5"></circle>
        </g>
        <g id="ring-overlay">
            <circle r="105" cx="100" cy="100" fill="white" opacity="1%" z-index="999"></circle>
        </g>
      </svg>
      <h3>Intro</h3>
    </div>
    <label for="percent">Type a percent!</label>
    <input id="percent" name="percent">
</body>

<script>

var $ringCenter = $('.ring-center');
var $ringLabel = $('#ring-label');


$("#ring-overlay").mouseover(svgHover);

$("#ring-overlay").mouseout(svgHoverReset);

$("#ring-overlay").click(svgClick);

function svgHover(){
    $ringLabel.css('animation','shake 0.5s');
    $ringLabel.css('animation-iteration-count','infinite');
    $ringcenter.css('animation-iteration-count','1');
}

function svgHoverReset(){
    $ringLabel.css('animation-play-state','paused');
    $ringCenter.css('animation-iteration-count','infinite');

}

function svgClick(){
    window.open('https://www.thrum.engineering/new-page');
}


var $ringClip = $('#ring-clip-circle');
var r = $ringClip.attr('r');
var c = Math.PI*(r*2);
var pct = 0.5*c;

$ringClip.css({ strokeDashoffset: pct})
$ringClip.css({ strokeDasharray: c})


$('#percent').on('change', function(){
  var val = parseInt($(this).val());
  var $circle = $('#svg #bar');
  
  if (isNaN(val)) {
   val = 0; 
  }
  else{
    var r = $circle.attr('r');
    var c = Math.PI*(r*2);
   
    if (val < 0) { val = 0;}
    if (val > 100) { val = 100;}
    
    var pct = ((100-val)/100)*c;

    var $ringClip = $('#ring-clip-circle');
    var deg = val*3.6;
    console.log(deg)

    $ringClip.css('transform-origin','center');   
    $ringClip.css('transition','transform 1s');   
    $ringClip.css('transform','rotate('+deg+'deg)');   
    $circle.css({ strokeDashoffset: pct});
    
    $('#cont').attr('data-pct',val);

    if (val == 100){
        var $badge = $('#badge');
        $badge.css('transition','fill 1s linear');   
        $badge.css('fill','rgb(28, 176, 246)');   

    }

  }
});
</script>

</html>